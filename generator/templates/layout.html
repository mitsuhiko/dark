<!doctype html>
<html lang="en">
  <head>
    <meta charset=utf-8>
  {% block htmlhead %}
    <title>{% block title %}Home{% endblock %} | Dark Thoughts</title>
    <link href="/feed.atom" rel="alternate" title="dark" type="application/atom+xml">
    <link href="/feed.xml" rel="alternate" title="dark" type="application/rss+xml">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    {%- for link in links %}
    <link rel="{{ link.rel }}" href="{{ link.href }}"{%
      if link.media %} media="{{ link.media }}"{% endif %} type="{{ link.type }}">
    {%- endfor %}
    <link rel="apple-touch-icon" sizes="300x300" href="/static/avatar-colorized.jpg">
    <link rel="icon" type="image/png" sizes="300x300" href="/static/avatar-colorized.jpg">
    {% block social_image %}
    <meta name="twitter:image" content="https://dark.ronacher.eu/static/avatar-colorized.jpg">
    <meta property="og:image" content="https://dark.ronacher.eu/static/avatar-colorized.jpg">
    {% endblock %}
    <link rel="stylesheet" href="/static/fonts.css" type="text/css">
    <link rel="stylesheet" href="/static/style.css" type="text/css">
    <link rel="stylesheet" href="/static/_pygments.css" type="text/css">
    <noscript><style>img.dithered-image { visibility: visible; }</style></noscript>
    <meta name="title" content="{{ self.title() }}">
    <meta property="og:title" content="{{ self.title() }}">
    <meta property="og:site_name" content="Dark Thoughts">
    <meta name="twitter:site" content="@mitsuhiko">
    <meta name="twitter:url" content="https://dark.ronacher.eu{{ slug }}">
    <meta property="og:url" content="https://dark.ronacher.eu{{ slug }}">
    <link rel="canonical" href="https://dark.ronacher.eu{{ slug }}">
    <meta name="twitter:title" content="{{ self.title() }}">
    <meta name="twitter:domain" content="https://dark.ronacher.eu/">
    {% block twitter_card %}
    <meta name="twitter:card" content="summary">
    {% endblock %}
    <meta name="twitter:creator" content="@mitsuhiko">
    <link rel="me" href="https://hachyderm.io/@mitsuhiko">
    <script type="speculationrules">
      {
        "prefetch": [
          {
            "where": { "href_matches": "/*" },
            "eagerness": "moderate"
          }
        ]
      }
    </script>
  {% endblock %}
  </head>
  <body hx-boost="true" hx-ext="head-support" hx-select="div.body" hx-target="div.body" hx-swap="innerHTML show:window:top">
    <div class="header-image">
      <canvas id="header-canvas"></canvas>
    </div>
    <script src="/static/htmx.min.js"></script>
    <script src="/static/htmx-head-support.js"></script>
    <script src="/static/app.js"></script>
    <script>
      function updateDateWarning() {
        const dateEl = document.querySelector("p.date");
        if (dateEl) {
          if (dateEl.querySelector(".date-warning")) {
            return;
          }
          const pubDate = new Date(dateEl.dataset.date);
          if (Number.isNaN(pubDate.getTime())) {
            return;
          }
          const now = new Date();
          const dayDiff = Math.floor((now.getTime() - pubDate.getTime()) / (1000 * 60 * 60 * 24));
          const yearDiff = Math.floor(dayDiff / 365);

          if (dayDiff >= 365) {
            const warning = document.createElement("span");
            warning.className = "date-warning";
            warning.textContent = `this article is ${yearDiff} year${yearDiff != 1 ? 's' : ''} old.`;
            dateEl.appendChild(document.createTextNode(" â€” "));
            dateEl.appendChild(warning);
          }
        }
      }

      document.addEventListener("DOMContentLoaded", updateDateWarning);
      document.addEventListener("htmx:afterSettle", updateDateWarning);
    </script>
    <div class=container>
      <div class=header>
        <a href="/">Dark Thoughts</a>
      </div>
      <div class=navigation>
        <ul>
          <li><a href="/">entries</a>
          <li><a href="/archive/">archive</a>
          <li><a href="/about/">about</a>
        </ul>
      </div>
      <div class=body hx-history-elt>
        {% block body %}{% endblock %}
      </div>
      <div class=footer>
        <p>&copy; Copyright {{ format_date(format='YYYY') }} by <a href="https://mitsuhiko.at/">Armin Ronacher</a>.
        <p>
          Subscribe via <a href="/feed.atom" rel="alternate" title="Dark Thoughts">atom</a> / <a href="/feed.xml" rel="alternate" title="dark">RSS</a>.
      </div>
    </div>
  </body>
</html>
